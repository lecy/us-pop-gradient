### LOAD DATA

pop.gradient <- structure(list(dist = c(0L, 10L, 20L, 30L, 40L, 50L, 60L, 70L, 
80L, 90L, 100L, 110L, 120L, 130L, 140L, 150L, 160L, 170L, 180L, 
190L, 200L, 210L, 220L, 230L, 240L, 250L, 260L, 270L, 280L, 290L, 
300L, 310L, 320L, 330L, 340L, 350L, 360L, 370L, 380L, 390L, 400L, 
410L, 420L, 430L, 440L, 450L, 460L, 470L, 480L, 490L, 500L, 510L, 
520L, 530L, 540L, 550L, 560L, 570L, 580L, 590L, 600L, 610L, 620L, 
630L, 640L, 650L, 660L, 670L, 680L, 690L, 700L, 710L, 720L, 730L, 
740L, 750L, 760L, 770L, 780L, 790L, 800L, 810L, 820L, 830L, 840L, 
850L, 860L, 870L, 880L, 890L, 900L, 910L, 920L, 930L, 940L, 950L, 
960L, 970L, 980L, 990L, 1000L, 1010L, 1020L, 1030L, 1040L, 1050L, 
1060L, 1070L, 1080L, 1090L, 1100L, 1110L, 1120L, 1130L, 1140L, 
1150L, 1160L, 1170L, 1180L, 1190L, 1200L, 1210L, 1220L, 1230L, 
1240L, 1250L, 1260L, 1270L, 1280L, 1290L, 1300L, 1310L, 1320L, 
1330L, 1340L, 1350L, 1360L, 1370L, 1380L, 1390L, 1400L, 1410L, 
1420L, 1430L, 1440L, 1450L, 1460L, 1470L, 1480L, 1490L, 1500L, 
1510L, 1520L, 1530L, 1540L, 1550L, 1560L, 1570L, 1580L, 1590L, 
1600L, 1610L, 1620L, 1630L, 1640L, 1650L, 1660L, 1670L, 1680L, 
1690L, 1700L, 1710L, 1720L, 1730L, 1740L, 1750L, 1760L, 1770L, 
1780L, 1790L, 1800L, 1810L, 1820L, 1830L, 1840L, 1850L, 1860L, 
1870L, 1880L, 1890L, 1900L, 1910L, 1920L, 1930L, 1940L, 1950L, 
1960L, 1970L, 1980L, 1990L, 2000L, 2010L, 2020L, 2030L, 2040L, 
2050L, 2060L, 2070L, 2080L, 2090L, 2100L, 2110L, 2120L, 2130L, 
2140L, 2150L, 2160L, 2170L, 2180L, 2190L, 2200L, 2210L, 2220L, 
2230L, 2240L, 2250L, 2260L, 2270L, 2280L, 2290L, 2300L, 2310L, 
2320L, 2330L, 2340L, 2350L, 2360L, 2370L, 2380L, 2390L, 2400L, 
2410L, 2420L, 2430L, 2440L, 2450L, 2460L, 2470L, 2480L, 2490L, 
2500L, 2510L, 2520L, 2530L, 2540L, 2550L, 2560L, 2570L, 2580L, 
2590L, 2600L, 2610L, 2620L, 2630L, 2640L, 2650L, 2660L, 2670L, 
2680L, 2690L, 2700L, 2710L, 2720L, 2730L, 2740L, 2750L, 2760L, 
2770L, 2780L, 2790L, 2800L, 2810L, 2820L, 2830L, 2840L, 2850L, 
2860L, 2870L, 2880L, 2890L, 2900L), chicago = c(0, 0.000157558735761154, 
0.000641180057160496, 0.00121281659266154, 0.00208941165214078, 
0.00510573946834184, 0.00618028740419771, 0.0149563228406688, 
0.0164726996118489, 0.0210296400392006, 0.0261791857399591, 0.0326316962076059, 
0.0350865593238266, 0.038457815571225, 0.0431162004842812, 0.0554549495043278, 
0.0616189207301673, 0.0749744892169457, 0.080325396663888, 0.0879148586500213, 
0.0933802016630671, 0.114054848831187, 0.121657350227632, 0.133159936992745, 
0.137013548317843, 0.144160801273342, 0.150607051406362, 0.153392629667769, 
0.156629844514682, 0.160770938267507, 0.16862758089625, 0.172582820360719, 
0.178419111559859, 0.189634705640355, 0.196112399214251, 0.203200506023202, 
0.211978175010706, 0.222518564775853, 0.230412411771007, 0.244190731665767, 
0.261254999068908, 0.273462732140973, 0.28234552835349, 0.292022745886773, 
0.302639390587387, 0.315586445658317, 0.331494816217389, 0.34451084129502, 
0.361598474599712, 0.372010342240347, 0.38126447650025, 0.391402500414381, 
0.397880023222587, 0.416071566495792, 0.440694348631289, 0.464141766634083, 
0.478188913610462, 0.485556373755909, 0.498474511429373, 0.503122482857348, 
0.509270540654097, 0.520461911782599, 0.525796490163207, 0.532300971396438, 
0.536754627579427, 0.540060770547117, 0.547793595162802, 0.553863799914988, 
0.562199134214087, 0.570837809596101, 0.578506999827391, 0.590780036276819, 
0.591753507034303, 0.595243216674505, 0.600137876862317, 0.602676266954794, 
0.604077895626438, 0.605705647069283, 0.607676470004865, 0.60917897286925, 
0.615994817950822, 0.617435539077447, 0.620835738498264, 0.623939553121527, 
0.63079762243639, 0.634310337114799, 0.638351281623566, 0.652214578391949, 
0.661129088692851, 0.661534583100184, 0.671606098611141, 0.672210106521833, 
0.676475765790359, 0.678101632366627, 0.681050955592556, 0.683040411320288, 
0.698546544908109, 0.705981180409518, 0.707776536765872, 0.709647790416343, 
0.714566483458495, 0.722587934309829, 0.723346762261257, 0.728283669236319, 
0.738343070049285, 0.738827181113794, 0.740897083591378, 0.745025601901049, 
0.747513860986599, 0.750050015015137, 0.754589624335974, 0.761333580284149, 
0.765832473264956, 0.76633040346236, 0.767158059652747, 0.767470038901971, 
0.769390792048515, 0.769681444918483, 0.77083585642325, 0.771660541935034, 
0.772011230221934, 0.772168212220743, 0.772627091849091, 0.774228777359289, 
0.774515367294638, 0.776083734163367, 0.779329332639049, 0.780224602376602, 
0.782854004137736, 0.78382135955033, 0.784128383372556, 0.784368090071078, 
0.784407691601134, 0.785075623875693, 0.785273067676995, 0.785657441912697, 
0.785657441912697, 0.789151034055847, 0.789403329085499, 0.789454146377179, 
0.78977087162378, 0.79015539084922, 0.790897457987097, 0.791418850745877, 
0.79198424950071, 0.794752822077011, 0.799174564407979, 0.800401928304212, 
0.800767070456854, 0.80083592769376, 0.801061744375516, 0.801246683617535, 
0.801459953854084, 0.802265033531486, 0.80276687200779, 0.803285132988259, 
0.803527932801162, 0.803993617281148, 0.804262463694731, 0.806123068654548, 
0.806852869660709, 0.807039091256398, 0.807207443672551, 0.820946990089752, 
0.824901001974451, 0.824917227936973, 0.826431581295829, 0.826431581295829, 
0.828010036228231, 0.834965277664561, 0.835123519463081, 0.835165688922471, 
0.836961454472082, 0.837886099130269, 0.838110288704981, 0.838110288704981, 
0.838399987864681, 0.838725834576712, 0.839011970210886, 0.846493901364371, 
0.846597743013721, 0.855177443014877, 0.855358525529902, 0.855492289838891, 
0.855496665306942, 0.856942573844143, 0.857226508856315, 0.869153641680149, 
0.869307363020882, 0.870875662227734, 0.881856282719109, 0.917640320003819, 
0.931183569649635, 0.934239176796477, 0.938515723183224, 0.946013857745272, 
0.949138969749844, 0.95159864652532, 0.964517096732216, 0.965653120316389, 
0.970117286644284, 0.972153077869838, 0.98918828610777, 0.990113990802032, 
0.991205399433256, 0.993874035417113, 0.996493851745662, 0.997213567910145, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
    los.angeles = c(0, 0.0327686212928525, 0.0327686212928525, 
    0.0327686212928525, 0.0327686212928525, 0.0429816210107733, 
    0.0457220430242158, 0.0457220430242158, 0.0457220430242158, 
    0.0485644089324555, 0.0485644089324555, 0.0499974520470289, 
    0.0606284893954958, 0.0674853214646067, 0.0750925334164934, 
    0.0774808816855525, 0.0779672900318886, 0.0779672900318886, 
    0.0780261236450049, 0.0786066979922685, 0.0817476944279826, 
    0.0817476944279826, 0.0817476944279826, 0.0836451138929179, 
    0.0906484178159316, 0.0915783078805891, 0.0916822784097046, 
    0.0923404512639941, 0.0948716563095235, 0.102107929741299, 
    0.102122357831087, 0.104622528628997, 0.109904424183314, 
    0.116835371783778, 0.130587622523899, 0.137925652974811, 
    0.137925652974811, 0.143540399856433, 0.144473814782687, 
    0.145472800511818, 0.147119291072618, 0.151804895392225, 
    0.152042478796604, 0.15304008551224, 0.153151730831413, 0.153156618596533, 
    0.154961544275503, 0.155698617322454, 0.155766227647625, 
    0.155800361453614, 0.156563684086876, 0.15696130716251, 0.157706315981043, 
    0.157816720832469, 0.157850132911769, 0.160140751654375, 
    0.160140751654375, 0.163925960043741, 0.165456226831687, 
    0.166246121250677, 0.166517906122922, 0.167671918100414, 
    0.168668445448011, 0.169616127364346, 0.170560371412927, 
    0.17221879946204, 0.173805515587434, 0.176129188767989, 0.17730761379513, 
    0.178613011167599, 0.179224871078026, 0.179829765037108, 
    0.183803914385223, 0.184700682350054, 0.185041424341024, 
    0.18571503376927, 0.185916095869998, 0.186549030844137, 0.18797309103903, 
    0.19010350578868, 0.190505485000399, 0.192961682022197, 0.198415731945759, 
    0.203842536686817, 0.208526613781198, 0.208980689416274, 
    0.213043466157379, 0.215778120801299, 0.217095810081437, 
    0.217891600749714, 0.218195895542898, 0.218925155254043, 
    0.223278185337841, 0.225520383952412, 0.234335421628028, 
    0.235999375397103, 0.237965194575775, 0.238864736677566, 
    0.242107032609249, 0.242358132279073, 0.243413763887294, 
    0.244309835901389, 0.244641640080597, 0.245584865979027, 
    0.245751723389895, 0.246008696755048, 0.246734425160609, 
    0.247897761589162, 0.248106150504579, 0.248289108220198, 
    0.248825128832403, 0.249052446963431, 0.249579049686745, 
    0.250865208532165, 0.251090158497496, 0.251653984919186, 
    0.252892264931588, 0.253687978272006, 0.254347420591989, 
    0.261149356324831, 0.262072892617031, 0.270602658152904, 
    0.281313694394036, 0.284607680777811, 0.299798007387362, 
    0.303880393184843, 0.305240432356044, 0.309737717561772, 
    0.311578697355242, 0.313249436643989, 0.317165561099519, 
    0.320716536958419, 0.3250375951943, 0.327286334456989, 0.331610353705491, 
    0.333900808126395, 0.341589613858049, 0.362018967389798, 
    0.36304159933397, 0.365815855507945, 0.366829085673198, 0.369040704341324, 
    0.371754767220653, 0.372940432068642, 0.375964573220648, 
    0.378456379721753, 0.379879869623682, 0.38103324042434, 0.38492861845956, 
    0.386606584681178, 0.388740076435238, 0.393602313695953, 
    0.396459268793689, 0.400617796756841, 0.40350494193973, 0.405407403825505, 
    0.407461312324144, 0.410220396127684, 0.414507558985144, 
    0.41680716064743, 0.41955211922863, 0.426298275798807, 0.429802568184517, 
    0.431890107858058, 0.433633818870238, 0.434923799000715, 
    0.437136210279401, 0.442101232375386, 0.444229965244091, 
    0.446802018731411, 0.451450492790472, 0.454441962921833, 
    0.463340985096872, 0.466614157398461, 0.485211488280467, 
    0.488765483147882, 0.49798920822703, 0.503226272954791, 0.506639859761287, 
    0.51140192844598, 0.519399765302214, 0.526552405431926, 0.530974589176092, 
    0.537080042544242, 0.539405452379642, 0.543004986912324, 
    0.548126978119141, 0.551186470990924, 0.556419898087294, 
    0.562986544475589, 0.567482376561957, 0.574651126662402, 
    0.581990951764054, 0.589512613327361, 0.597031094782446, 
    0.603999826708267, 0.610842304793455, 0.623819073094404, 
    0.630922365161768, 0.636141860355449, 0.641800204039868, 
    0.643801439378199, 0.647469196414941, 0.650981431016223, 
    0.654406391462056, 0.661259769553442, 0.667539690682633, 
    0.670395985271569, 0.672146298149754, 0.676050723544538, 
    0.679433765846524, 0.682191480302551, 0.689382678036216, 
    0.699330855611243, 0.708050509372143, 0.716414751402724, 
    0.723962639998384, 0.730570653569527, 0.733809837054863, 
    0.736596449576391, 0.747802203686763, 0.756047592797266, 
    0.760791318669282, 0.768383680450147, 0.770525233633562, 
    0.77536110853817, 0.781732376423411, 0.786104951123702, 0.794482187456676, 
    0.803187757881162, 0.812235848837387, 0.824963170351509, 
    0.830989926512629, 0.845859629262661, 0.848344850007731, 
    0.851195161353536, 0.855752610855963, 0.858657274021026, 
    0.865979055955457, 0.876076669619001, 0.879188809875139, 
    0.881153575461726, 0.886622214574783, 0.897451694542737, 
    0.910646914046824, 0.930191891403229, 0.942606563493345, 
    0.947709706034405, 0.951909188765154, 0.952738642828275, 
    0.955665080229781, 0.966242825795063, 0.966864548229573, 
    0.967822756400785, 0.968797870375283, 0.97211980755828, 0.973906957495543, 
    0.982189322210872, 0.982865953869627, 0.990790506468997, 
    0.993475216981652, 0.995767865580569, 0.996854537880399, 
    0.997200041978717, 0.998090507722998, 0.99859033245296, 0.998699780372125, 
    0.998699780372125, 0.998880489135829, 0.99900890171254, 0.999721993457058, 
    0.999721993457058, 0.999898104435115, 0.999898104435115, 
    0.999898104435115, 0.999898104435115, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1), new.york = c(0, 0.0206579217965056, 
    0.0371076002601773, 0.0473364618552817, 0.0547559990921194, 
    0.0598094230415034, 0.0617547181174625, 0.075382661101415, 
    0.0782022378450561, 0.0898095361979379, 0.0973893032036842, 
    0.102643267290745, 0.106606581072545, 0.111321231669383, 
    0.11569780486441, 0.12362966172451, 0.126317365469726, 0.133711484394742, 
    0.143353201996518, 0.153926881405187, 0.156784806323161, 
    0.169342000102356, 0.172683836321202, 0.180354830869214, 
    0.183106520196187, 0.186476439316015, 0.187933779488448, 
    0.192886358243038, 0.194252950950333, 0.199900855373717, 
    0.202496893385464, 0.207037968713638, 0.211883419384849, 
    0.213183326479293, 0.216921429314236, 0.217761016548948, 
    0.221110111920606, 0.221663724620852, 0.223284297460737, 
    0.225886872898607, 0.230019747344365, 0.235429939483604, 
    0.238167490700262, 0.245036969096398, 0.248794742205606, 
    0.251070172467805, 0.25497508116171, 0.257984133715128, 0.268797603594168, 
    0.271295306344561, 0.280203214779457, 0.288899296431181, 
    0.291456757507011, 0.297442494460651, 0.303967203373134, 
    0.311144894507336, 0.314868282495013, 0.32209122331501, 0.326490073377566, 
    0.329437682502609, 0.334507893041497, 0.339076664631354, 
    0.345522830992527, 0.349700668366599, 0.354645317793595, 
    0.366278008682346, 0.368678172003941, 0.37282387643039, 0.376764919788649, 
    0.379222631147695, 0.383726344231746, 0.388862293117206, 
    0.411894450848408, 0.421614205148414, 0.429117530343033, 
    0.436006849779124, 0.449616143860956, 0.455808842386606, 
    0.46106366352411, 0.465615252219184, 0.46855977145184, 0.473674545391769, 
    0.475922424382021, 0.479928378034357, 0.485551041355597, 
    0.488840968026747, 0.492527866930714, 0.498536760356285, 
    0.502138530952905, 0.507649452295148, 0.511883619792885, 
    0.516914563889109, 0.520684848001588, 0.525510570402641, 
    0.528539473661996, 0.538568800381597, 0.541207684471505, 
    0.544862131450428, 0.548940770068716, 0.553930572521682, 
    0.557767336039387, 0.567153939366632, 0.575224380638965, 
    0.582238497574335, 0.585622719126179, 0.592103003183369, 
    0.596439559211095, 0.600466819910723, 0.608576459963842, 
    0.617563039829815, 0.620638056269395, 0.623496506372415, 
    0.635545124485546, 0.637607896690083, 0.639690973901731, 
    0.641422869861375, 0.645686141632238, 0.646837511574531, 
    0.647421488347613, 0.650208191084977, 0.651065621723272, 
    0.652407724053059, 0.653354084951794, 0.656440768232179, 
    0.657482219844161, 0.658019136170739, 0.658938364656766, 
    0.659980438113618, 0.66237749865485, 0.663980337638953, 0.664627710368863, 
    0.665879313327061, 0.669842495007101, 0.671639536466394, 
    0.673089946129418, 0.677338677040697, 0.67962162421524, 0.679864694675651, 
    0.691621938192125, 0.69274692966834, 0.700218769536159, 0.702363718701404, 
    0.717901463273797, 0.720212770440817, 0.722091579667562, 
    0.723818304326601, 0.726776101397135, 0.727016436384516, 
    0.728699844554248, 0.729461630296303, 0.731818866989883, 
    0.732152639807513, 0.736619686598176, 0.736973902968667, 
    0.738439175690688, 0.739153511124947, 0.740499057766476, 
    0.741344428480681, 0.741939379365826, 0.749241655347694, 
    0.753739137095065, 0.755585446066853, 0.759443184766453, 
    0.762590354542952, 0.764074069959468, 0.768293429172108, 
    0.768673560041519, 0.769420553608447, 0.769991906608463, 
    0.771886957907701, 0.773472894310511, 0.776649158694154, 
    0.777117221005819, 0.77763970279862, 0.777815836330636, 0.778625024050575, 
    0.778691555007708, 0.779373751050354, 0.779735571327031, 
    0.780176581775842, 0.780361727225486, 0.781001476717245, 
    0.783283128650141, 0.7840952226088, 0.784625401745617, 0.784714183794326, 
    0.785028843742679, 0.785495726804487, 0.785540042111979, 
    0.788952427114658, 0.789373332319995, 0.790172309540483, 
    0.790452278277861, 0.791022580907785, 0.791414675041463, 
    0.791881612877171, 0.792392785470518, 0.795520578174219, 
    0.799332648328786, 0.800429170264721, 0.800935629080631, 
    0.800935629080631, 0.801890380052124, 0.802142394768286, 
    0.802524665041811, 0.802659192963412, 0.802676259866407, 
    0.803419435370271, 0.803830217069999, 0.804267473895629, 
    0.804503117659532, 0.804575725297625, 0.805183187186042, 
    0.806529664983879, 0.808223457640746, 0.80852142765942, 0.81001119075895, 
    0.827502356276539, 0.829845983266844, 0.830024584846376, 
    0.830165679192049, 0.830236450293478, 0.830319545522518, 
    0.837351025784343, 0.8376103640932, 0.837875965958678, 0.838957135092505, 
    0.838957135092505, 0.839599964810669, 0.840213139294707, 
    0.840272391767063, 0.840293766476231, 0.847228570803689, 
    0.84820531832922, 0.856673092697712, 0.856830371119983, 0.856830371119983, 
    0.858295514962238, 0.869007943104842, 0.869630316382169, 
    0.872614334041068, 0.883274256567059, 0.886202804374731, 
    0.891797922868012, 0.90628746897268, 0.945316389450371, 0.948634344248603, 
    0.949147791569817, 0.951670551768689, 0.957060435678822, 
    0.965067316672625, 0.968073163341867, 0.968759499646992, 
    0.971721175998479, 0.976798735906015, 0.990317366294557, 
    0.990597918212875, 0.991569027248649, 0.996931163345192, 
    0.997213567910145, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), houston = c(0, 
    0.00103820706387677, 0.00103820706387677, 0.00103820706387677, 
    0.00227923865927978, 0.00227923865927978, 0.0192079664346569, 
    0.0202839900438319, 0.0204024627686011, 0.0228763936461811, 
    0.0230599699846758, 0.0233262935768425, 0.0240084670655298, 
    0.0252352510028167, 0.0253368243682871, 0.0258977252192918, 
    0.0264406505649528, 0.0268617619779147, 0.0271270351999896, 
    0.0349358183276796, 0.0369665445784349, 0.0376009552258934, 
    0.045770675803864, 0.0467518149074168, 0.0473857712537007, 
    0.0488102277538735, 0.0493367982572466, 0.0601111950132707, 
    0.0608665206570615, 0.0714450556109101, 0.0755975358910494, 
    0.0790024007593905, 0.0793163003171254, 0.0805478592497375, 
    0.0825027558682534, 0.0830729006204646, 0.0841139527051727, 
    0.086211925195761, 0.0874357513424213, 0.0886844061759751, 
    0.0904910330678543, 0.091210961883951, 0.0947017154502571, 
    0.0954935108457929, 0.0991643448869447, 0.100212923549979, 
    0.101167929059009, 0.10712180049054, 0.108355147629903, 0.113437911057986, 
    0.11531481608619, 0.121342158650244, 0.123373190990443, 0.124940945680285, 
    0.126272412207393, 0.127918822218341, 0.132885716292925, 
    0.136734575176656, 0.137962245162334, 0.139896604790159, 
    0.14220781851935, 0.145168641042388, 0.147837847319209, 0.150626425257166, 
    0.153377624841028, 0.156365660326628, 0.159624939389457, 
    0.164562300665694, 0.174642563890758, 0.184510568585436, 
    0.197538898458713, 0.205324744210073, 0.210597792168464, 
    0.21489723726761, 0.218593972919706, 0.224226869294356, 0.229738576803171, 
    0.235757683950186, 0.24224497906664, 0.247189151638502, 0.255431818163951, 
    0.264102143194467, 0.27278905505085, 0.283416396772031, 0.29392723762886, 
    0.298922714013518, 0.305344689642638, 0.315687732266309, 
    0.319680127767276, 0.329244175978155, 0.340633899510307, 
    0.35738371317272, 0.376915335363387, 0.387259144821665, 0.391935782331561, 
    0.400913701477268, 0.408886661316696, 0.430655726458574, 
    0.435627208652823, 0.441641614910379, 0.451956819504623, 
    0.462654842111396, 0.466925456806919, 0.477337698198876, 
    0.485205820792763, 0.492364879134816, 0.497477793984122, 
    0.500349976226194, 0.520792813803446, 0.527881300807706, 
    0.539626503732055, 0.546034631230333, 0.559439844202922, 
    0.567169785133845, 0.575604566282277, 0.586088155512615, 
    0.590161954695695, 0.596366642261565, 0.598820158584232, 
    0.602079924168177, 0.607000608402711, 0.61356846303881, 0.622557768711831, 
    0.628001231162627, 0.630615109355963, 0.637804145131556, 
    0.643078311121915, 0.654574711658266, 0.664800470473008, 
    0.666889286056231, 0.673865724992051, 0.683659356395843, 
    0.698457965845032, 0.702845877237461, 0.707132395696091, 
    0.717294223702976, 0.722155004622337, 0.727534881018651, 
    0.731081906712727, 0.744990868804149, 0.752672251061289, 
    0.760666969027189, 0.806345073717228, 0.829279872451304, 
    0.835125323779803, 0.839828468635543, 0.843437230959461, 
    0.852075281274612, 0.852274522948647, 0.862609375263197, 
    0.862811523175952, 0.865226971637778, 0.870390481461168, 
    0.87557219877348, 0.879903767154267, 0.881812035073494, 0.883601201979093, 
    0.889559935399791, 0.8905971339795, 0.89351975976193, 0.903576512095708, 
    0.913792956125371, 0.915302151071599, 0.922606724335293, 
    0.93433717052645, 0.934641474985617, 0.941890388300429, 0.94767552067651, 
    0.951802460209049, 0.952996134934486, 0.95373387171223, 0.955070593311792, 
    0.958507194822477, 0.962108720547542, 0.962372820963748, 
    0.964336188204875, 0.964761900625478, 0.966133986832793, 
    0.966795259245451, 0.966943712625754, 0.967951220529402, 
    0.968881271693767, 0.969386328942224, 0.969410758101843, 
    0.971125455056732, 0.974078676895579, 0.975504721838866, 
    0.978160018766956, 0.980221373294068, 0.980503529765471, 
    0.982940568810073, 0.986389204468896, 0.993370379736111, 
    0.995942027252168, 0.996945385227355, 0.998176112885478, 
    0.998243285019445, 0.999383548747914, 0.999612703415606, 
    0.999612703415606, 0.999763228538146, 0.999763228538146, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), seattle = c(0, 0.00682136435754552, 
    0.00682136435754552, 0.00682136435754552, 0.0128677134650705, 
    0.0128677134650705, 0.0130071259297982, 0.0152126582509812, 
    0.0152126582509812, 0.0161125483281401, 0.0174114179404681, 
    0.0178153239046873, 0.0181959992911097, 0.0200378103590695, 
    0.0233937460243009, 0.0252442210345207, 0.0256310600957456, 
    0.0271208586372107, 0.0276820881316183, 0.0287476015958872, 
    0.0294641054322061, 0.0312182363734554, 0.0316137877068525, 
    0.0320896697983118, 0.0327284011399209, 0.0336749328043455, 
    0.0349953027836135, 0.0350439774491856, 0.0351356012967315, 
    0.0351356012967315, 0.0355099357986735, 0.0355713212311539, 
    0.0358373000699469, 0.0359218967482591, 0.0361830232638674, 
    0.0362567940418472, 0.0370285325238206, 0.0385451509445617, 
    0.0390463450220364, 0.0404681111570968, 0.0404681111570968, 
    0.0406188811511912, 0.040887843556564, 0.0409524960911089, 
    0.0409923714906668, 0.0413575136433087, 0.0414423133072521, 
    0.0420700125409034, 0.043776512742684, 0.0442308912452091, 
    0.0448867990376135, 0.0451013709597982, 0.0451945671404875, 
    0.0456659609941007, 0.0457602784287531, 0.0470146587459053, 
    0.0471989954750185, 0.0484143445550793, 0.0488961196738326, 
    0.0506816489480402, 0.0511364463098044, 0.0526040356456172, 
    0.0526461599970894, 0.0598299374782346, 0.0616404790930019, 
    0.062015606205504, 0.0653303970054838, 0.0715052166856148, 
    0.0743721148572865, 0.0849528762090904, 0.0875777768444019, 
    0.0940139711336905, 0.097539138819476, 0.0985735052663301, 
    0.0986701940886744, 0.101816613140537, 0.10231543583032, 
    0.102359445048368, 0.103890204801418, 0.104215178353035, 
    0.106606142881341, 0.106689969503052, 0.106848556054946, 
    0.107405506741127, 0.108374785684226, 0.108518480179175, 
    0.118337732880421, 0.118389503882368, 0.118400117131086, 
    0.119269929892887, 0.120950293278151, 0.121016340936161, 
    0.124580146775752, 0.131778561776305, 0.166145015074357, 
    0.166869016491055, 0.167501571269885, 0.168868760046097, 
    0.179223952809694, 0.180498154834836, 0.192204429625906, 
    0.193439513420115, 0.196165065930571, 0.199162941386294, 
    0.210148133887363, 0.210314614324916, 0.213354994327422, 
    0.213622606717247, 0.213971880548717, 0.21472315936786, 0.22892103445241, 
    0.229150211674061, 0.229966384677309, 0.230492227010005, 
    0.230627170568852, 0.232659720468294, 0.232787131004826, 
    0.235643490033644, 0.236257676223845, 0.240102568832782, 
    0.240320382081078, 0.240616199807662, 0.241217594681101, 
    0.241698380647652, 0.242711726804693, 0.243849554705588, 
    0.244756645939664, 0.245085543880151, 0.245765152661498, 
    0.246404969815134, 0.24743768982298, 0.249258264727519, 0.249954437780773, 
    0.25212628093116, 0.256033312919208, 0.257207098274778, 0.262935214242441, 
    0.267994563439061, 0.270574398042244, 0.273758685191312, 
    0.274904780729186, 0.277408627822417, 0.279407356449303, 
    0.28097788205411, 0.284061266012489, 0.285036531420713, 0.28716372739821, 
    0.288798370686534, 0.29288645619166, 0.294029271739494, 0.3014650091629, 
    0.302391545131651, 0.305562773538443, 0.306861755920566, 
    0.311246519424713, 0.312495467459734, 0.314384448522, 0.316100891797717, 
    0.318085305104609, 0.32093353826419, 0.32401061355803, 0.328806000884193, 
    0.33218365923396, 0.338239500336241, 0.345798324380034, 0.353227740250926, 
    0.364410592426904, 0.368428013156407, 0.371442936183161, 
    0.383449436388808, 0.387087058114297, 0.411196982553507, 
    0.41515345281974, 0.417924599769365, 0.424792022533235, 0.431876530374725, 
    0.436303933749408, 0.444379172571025, 0.449664570432979, 
    0.453173415496418, 0.456260540190002, 0.458667634021005, 
    0.461052122341077, 0.465740043274474, 0.470609443028178, 
    0.481217849089759, 0.500297058194331, 0.507062897926749, 
    0.51115879676768, 0.516862515795665, 0.520994655626757, 0.535436438890196, 
    0.538491949377214, 0.545063332096904, 0.551545030609524, 
    0.560813241761854, 0.56467599710634, 0.567517563960031, 0.571610720883944, 
    0.583952389030687, 0.586815221045746, 0.590026347406054, 
    0.594496464757138, 0.596857458295893, 0.601006581258132, 
    0.605220894827938, 0.610239034719423, 0.612529711457923, 
    0.617584243773293, 0.622146716364595, 0.628777896073651, 
    0.635630893969727, 0.638416201583626, 0.645659882379944, 
    0.65259271162499, 0.660033198267768, 0.662940381032254, 0.673430681676399, 
    0.677681477885927, 0.681200375571103, 0.687384812903762, 
    0.691570064086366, 0.694968307756736, 0.698837645635263, 
    0.704516693854068, 0.708939067695888, 0.717907198423378, 
    0.723044867853712, 0.730842151684293, 0.739568323539352, 
    0.750617872151504, 0.760139071062228, 0.772679877779194, 
    0.778931100606522, 0.789719873900428, 0.799070175019624, 
    0.813375013865852, 0.8318768190654, 0.847810089195237, 0.876075583806974, 
    0.891978087114705, 0.897390718303513, 0.902145289407827, 
    0.910616305102431, 0.918894400675516, 0.925944484731543, 
    0.931647134057472, 0.94134619026708, 0.942529351625617, 0.947643310401026, 
    0.953398098036235, 0.959541770698951, 0.959597507975692, 
    0.96723244518721, 0.96936223809199, 0.97077081016102, 0.971903324993567, 
    0.973847946672749, 0.974726281609067, 0.974726281609067, 
    0.977591826543198, 0.977635871203181, 0.978597839441562, 
    0.978723880630581, 0.980378658160327, 0.980378658160327, 
    0.984962875990124, 0.984962875990124, 0.991322792789986, 
    0.991322792789986, 0.991322792789986, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), rapid.city = c(0, 
    0.000350237207719862, 0.000350237207719862, 0.000350237207719862, 
    0.000377450170281746, 0.00051070862618951, 0.000590701074866269, 
    0.000629522882338225, 0.000662654648147349, 0.000706022689360108, 
    0.000759182370784277, 0.000813018670979224, 0.000853248489893229, 
    0.000908093274256052, 0.00108932400101202, 0.0011947057635637, 
    0.00144321495009408, 0.00153068886917916, 0.00156448114378833, 
    0.00164042032382871, 0.00180698131123537, 0.00269805923440341, 
    0.00288500577877538, 0.00319911154413567, 0.00369361353976796, 
    0.0039259837576182, 0.00508408766767693, 0.00647874394398813, 
    0.00672727890647168, 0.00723068004993679, 0.00996039215483605, 
    0.012630961335181, 0.01724829804281, 0.0177864806130872, 
    0.0207742486731731, 0.0225062509586238, 0.0232703662024465, 
    0.0263064255108011, 0.0270437079873712, 0.0304813888660951, 
    0.0317774488995273, 0.0326593731373249, 0.0346316169723259, 
    0.0358127259205911, 0.0367764759217349, 0.0387923036715564, 
    0.0406469221662487, 0.0461308141995963, 0.0494372954766721, 
    0.0537662830401484, 0.0581451889589375, 0.06023098875564, 
    0.0683511486196481, 0.071848404170142, 0.0737031322126353, 
    0.0776099193291282, 0.0817338205211875, 0.0826311781109472, 
    0.0844821170883241, 0.0865099725422948, 0.0890455466118869, 
    0.0904729383487272, 0.0930458778844371, 0.0947499615906078, 
    0.0968455723594865, 0.100375946787813, 0.108562602167018, 
    0.110538870272708, 0.116683448315779, 0.119570609608639, 
    0.124355908871128, 0.127735049338203, 0.132360940440291, 
    0.13909676407524, 0.143704763443832, 0.151493344668223, 0.158244150575953, 
    0.160343099330767, 0.169275237161645, 0.190510063454082, 
    0.192599165794784, 0.198675421451978, 0.205547480665425, 
    0.209534534100097, 0.227542024179674, 0.239555818980069, 
    0.244230810050957, 0.251867535469226, 0.255041515459018, 
    0.261431100380983, 0.266195501789438, 0.28824175186575, 0.296099364314732, 
    0.301053418742642, 0.305870631857153, 0.318245483321612, 
    0.336924111559923, 0.347779267599231, 0.359207993370528, 
    0.367762793800919, 0.392192749252726, 0.411651518933746, 
    0.42158218819258, 0.426942262212869, 0.445985810286227, 0.454598790264923, 
    0.478611184941317, 0.526449279065277, 0.551431381209993, 
    0.561044046090549, 0.574649067808143, 0.580872088520706, 
    0.594782845262868, 0.598118514584917, 0.607611359947151, 
    0.611029770078884, 0.615891672252208, 0.619794319106223, 
    0.622212022963951, 0.630123855130431, 0.636091461923008, 
    0.646493289829882, 0.653364324449191, 0.662727887296294, 
    0.667285784655908, 0.672351651946686, 0.681931014295743, 
    0.683646110777907, 0.68944008752792, 0.693060126831351, 0.696146748893848, 
    0.700449138895644, 0.70889483293825, 0.714388500501838, 0.719889794525572, 
    0.727310926649512, 0.732366293461366, 0.745687074077344, 
    0.752260808852761, 0.763056902517368, 0.773652304610574, 
    0.777612422174181, 0.785331453432925, 0.792334812129839, 
    0.80172892592544, 0.811997846573768, 0.824997226829638, 0.837353600157666, 
    0.848638863417593, 0.876194555940836, 0.889808380146438, 
    0.89830805870097, 0.899208683392794, 0.907763815688583, 0.910362592395354, 
    0.916955807347381, 0.923074377453702, 0.925880956672955, 
    0.937942581976456, 0.944705422032323, 0.958624865270704, 
    0.963034048268488, 0.966773124145664, 0.969623528929299, 
    0.971598253699793, 0.972567078341718, 0.973792689473136, 
    0.974924869218291, 0.977313820000255, 0.977357864660239, 
    0.978495943876677, 0.979125527976904, 0.979125527976904, 
    0.984962875990124, 0.984962875990124, 0.984962875990124, 
    0.991322792789986, 0.991322792789986, 0.991322792789986, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), maine = c(0, 
    0.000101895564885105, 0.000101895564885105, 0.000101895564885105, 
    0.000101895564885105, 0.000278006542942177, 0.000769979273169415, 
    0.000769979273169415, 0.000769979273169415, 0.00089613645397815, 
    0.00107910061358497, 0.00107910061358497, 0.00157512339045443, 
    0.00173980917726779, 0.002516312988584, 0.002516312988584, 
    0.00363492169439414, 0.00363492169439414, 0.00363492169439414, 
    0.00438365191616696, 0.00453600390938727, 0.00496449046695059, 
    0.00515987541399242, 0.00910688268341695, 0.00958371848514362, 
    0.0135755533591293, 0.0215024419042558, 0.0239246082238771, 
    0.0247112645387492, 0.0296306599756245, 0.0323748581662067, 
    0.0337879990229367, 0.0364323830568525, 0.0372919079913432, 
    0.0427114535795897, 0.0432400636052576, 0.0455399520250227, 
    0.0490007313797833, 0.055249453939654, 0.058304075156287, 
    0.0592904628883046, 0.063380887561181, 0.0657965357866439, 
    0.0787478599998178, 0.104443730507821, 0.110679339551516, 
    0.115049346322472, 0.12159029086346, 0.124005584669566, 0.128270103352164, 
    0.132140884684069, 0.13754223567137, 0.146878379348286, 0.153059688124628, 
    0.155424641494189, 0.156623922489441, 0.161323606923467, 
    0.163530656803893, 0.167062320029878, 0.171064752042612, 
    0.175085352880338, 0.17605450938766, 0.180328394407242, 0.182252997836792, 
    0.189605807574854, 0.190910950409785, 0.198872465726005, 
    0.2009082891715, 0.202535560537217, 0.204997798798039, 0.210495145878943, 
    0.212855691560511, 0.214350503524868, 0.217848935103225, 
    0.221044930979021, 0.226107602051606, 0.230131163901953, 
    0.232347834656901, 0.237237098004517, 0.238683563946705, 
    0.239595227190476, 0.252109703771276, 0.254076660313882, 
    0.260219997889207, 0.26339499602915, 0.266605484434617, 0.278749721668036, 
    0.282402941067188, 0.286206659812927, 0.291005604220627, 
    0.296671870788652, 0.300317702155227, 0.304264306675383, 
    0.30907070033355, 0.311769278309011, 0.317194049971763, 0.323863162217907, 
    0.333085621053355, 0.336555670085275, 0.339832750665764, 
    0.350460833445598, 0.35834087097384, 0.362036060068745, 0.385455002087272, 
    0.39085105933819, 0.401055543325582, 0.40926834840928, 0.414973646214397, 
    0.419769242970179, 0.423984732567849, 0.426501532077549, 
    0.428914551155788, 0.432503208236232, 0.435705387118795, 
    0.438422717100189, 0.443321946075701, 0.451737179385645, 
    0.454911243147286, 0.46613952544073, 0.474552203709317, 0.477485603840174, 
    0.481368915507315, 0.486288910235101, 0.48957150042558, 0.494194407961089, 
    0.503984160083929, 0.511457366077266, 0.51865875820041, 0.521822472916852, 
    0.525364630177772, 0.530864841611472, 0.533919111630743, 
    0.537251017663629, 0.541762154222193, 0.544902889676381, 
    0.550263176348284, 0.558023574789875, 0.564742151090157, 
    0.56616809937362, 0.569503585042003, 0.571538287233535, 0.575619716098754, 
    0.579097430254749, 0.586411885374491, 0.594875796572002, 
    0.599439329199377, 0.611839872845161, 0.613620978321405, 
    0.618241704566876, 0.628452542326725, 0.633143888239901, 
    0.636193457369712, 0.647513508500439, 0.649414256285328, 
    0.651618899336126, 0.652046280749697, 0.653446143768549, 
    0.654007366818969, 0.65522026073949, 0.656571275105086, 0.658988138022342, 
    0.659701390866567, 0.662305664295352, 0.662658769077862, 
    0.663715605711894, 0.664241270834912, 0.664792747353038, 
    0.665336110889903, 0.666415417711114, 0.669950319041216, 
    0.671318413197783, 0.672028972454901, 0.673868943764203, 
    0.675061410241835, 0.676288693588215, 0.680287436417651, 
    0.681349934095399, 0.692959523286119, 0.69448710615294, 0.695593451949029, 
    0.702547211268051, 0.7037029534564, 0.706766638142567, 0.706981767469739, 
    0.723639435321554, 0.725131647136635, 0.725665985867895, 
    0.729753636403812, 0.73226459121613, 0.734081344835612, 0.73811979552091, 
    0.739144901956587, 0.745795200978909, 0.749899744430136, 
    0.75286078927077, 0.756121260471433, 0.757948063490658, 0.758655658513161, 
    0.759961690618477, 0.760683658956869, 0.767370769262315, 
    0.768164517186304, 0.769071804962023, 0.770551422001985, 
    0.770861964241819, 0.771208592816095, 0.772174369451557, 
    0.772527551561927, 0.773849625976098, 0.774066395298291, 
    0.774735071853498, 0.778126011263138, 0.778664870452186, 
    0.781895486655087, 0.782808290484785, 0.78346868973703, 0.786258189165313, 
    0.786299082715021, 0.786765024954538, 0.787720243115182, 
    0.78846557413313, 0.789524086204118, 0.790556261694953, 0.790894587190313, 
    0.796387371927505, 0.797618057699703, 0.800403056002163, 
    0.80141870588502, 0.801775921932061, 0.801976868041, 0.802201383037121, 
    0.802441782464384, 0.803121043270363, 0.80400682101316, 0.804264944630224, 
    0.805877468928732, 0.806071687513892, 0.806372905302666, 
    0.808320188349014, 0.808871748638988, 0.80958938983924, 0.809822704101376, 
    0.810684735747312, 0.811225847110269, 0.811511982744443, 
    0.812287529623497, 0.813003633932542, 0.814949541187389, 
    0.815632352630917, 0.816061828340684, 0.829630341642603, 
    0.82964936107405, 0.834473385484187, 0.841684224494169, 0.84438323743884, 
    0.851204601796385, 0.851295668238944, 0.854422529786337, 
    0.855486219601919, 0.856503006848709, 0.857070390351937, 
    0.85990874165547, 0.865341822841126, 0.872494259985208, 0.87393074418953, 
    0.876624502061748, 0.885178989958707, 0.885631647916358, 
    0.88714292104881, 0.887493950867089, 0.887493950867089, 0.892454475059246, 
    0.893729147495533, 0.907764833838733, 0.91157348545751, 0.922466886567338, 
    0.960383603663583, 0.965809164714901, 0.966769534844185, 
    0.969597769086098, 0.971002854957461, 0.980768071594875, 
    0.988291982110097, 0.991405446605828, 0.997213567910145, 
    0.997213567910145, 0.997213567910145, 1, 1, 1, 1)), .Names = c("dist", 
"chicago", "los.angeles", "new.york", "houston", "seattle", "rapid.city", 
"maine"), class = "data.frame", row.names = c(NA, -291L))




hash.table <- structure(list(city = structure(c(1L, 4L, 3L, 2L, 6L, 5L), .Label = c("chicago", 
"houston", "los.angeles", "new.york", "rapid.city", "seattle"
), class = "factor"), fips = structure(c(2L, 3L, 1L, 5L, 6L, 
4L), .Label = c("06037", "17031", "36061", "46103", "48167", 
"53033"), class = "factor"), name = structure(c(1L, 4L, 3L, 2L, 
6L, 5L), .Label = c("Chicago, IL", "Houston, TX", "Los Angeles, CA", 
"New York, NY", "Rapid City, SD", "Seattle, WA"), class = "factor")), .Names = c("city", 
"fips", "name"), row.names = c(NA, -6L), class = "data.frame")





### SOURCE HELPER FUNCTIONS

# create a map 

mapReach <- function( county.i, distance.x, map.title )
{
    
    dist.temp <- d.mat[ county.i , ]
    
    # these <- names( temp[ temp < distance.x ] )
    
    col.vec <- rep( NA, length(dist.temp) )
    
    col.vec[ dist.temp < distance.x ] <- "steel blue"
    
    order <- match( us$GEOID, names( dist.temp ) )
    
    col.vec <- col.vec[ order ]
    
    col.border <- col.vec
    
    col.border[ is.na(col.border) ] <- "gray20"
    
    col.border[ col.border == "steel blue" ] <- "darkslategray3" # "cornflowerblue"
    
    # col.border <- "light gray"
    
    par( mar=c(0,0,1,0) )
    
    plot( us, border=col.border, col=col.vec, lwd=1, main=map.title )

}




popReach <- function( county.i, distance.x )
{

    dist.temp <- d.mat[ county.i , ]
    
    dist.temp <- data.frame( dist=as.numeric(dist.temp), GEOID=names(dist.temp) )
    
    pop.temp <- merge( pop, dist.temp, by.x="GEOID", by.y="GEOID" )
    
    prop.reached <- sum( pop.temp$PROP.POP[ pop.temp$dist < distance.x ], na.rm=T )
    
    return( prop.reached )

}

# popReach( county.i="39149", distance.x=500 )



# input value is a county
# output value is a data frame of population gradients and distances

cumPopulation <- function( county="39149" )
{

	cum.reach <- NULL

	increments <- seq( from=0, to=2900, by=10 )

	for( i in 1:length(increments) )
	{

	  cum.reach[i] <- popReach( county.i=county, distance.x=increments[i] )

	}
	
	# return( data.frame( dist=increments, pop=cum.reach ) )
	
	return( cum.reach )

}


# chicago <- cumPopulation( county="39149" )
# 
# plot( chicago$dist, chicago$pop, lty="l" ) 
